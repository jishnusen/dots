#!/bin/bash

stdout=$(mktemp)
stderr=$(mktemp)

aura --color=always $@ > >(tee -a $stdout) 2> >(tee -a $stderr >&2)


if cat $stdout | grep -q "^aura >>=.*You cannot perform this operation without using sudo."; then
  echo "+sudo aura $@"
  sudo aura $@
elif cat $stderr | grep -q "^.*error:.*you cannot perform this operation unless you are root.$"; then
  echo "+sudo aura $@"
  sudo aura $@
fi

rm $stdout $stderr
